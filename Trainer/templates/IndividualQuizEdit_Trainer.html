<!--First, based on the trainer's ID, the page should load the courses that the trainer is teaching-->
<!--Next, clicking view Course should bring the trainer to another page that allows them to edit the Sections-->
<!--To edit a different Course, they will have to press a return to homepage button-->
<!--Within each Section edit page, they should be able to add and delete Sections-->

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Trainers</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <!-- Vue.JS-->
        <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
        <style>
          
        </style>
    </head>

    <body>

        
        
        <div id="app" class ="container text-center">
            <h1>{{course_id}}</h1>
            <h2>Class {{class_id}} - Section {{section_id}}</h2>

            <div class="form-group">
              <label for="fname">Time limit:</label>
              <input type="number" id="time_limit" name="time_limit" v-model="time_limit"><br><br>
            
              <button id="quiz_submit" v-on:click="quiz_submit">Add Time Limit</button>
            
              <br><br><br>
              <button v-on:click="showTF">True/False</button>
              <button v-on:click="showMCQ">Multiple Choice</button>
              
              <br><br><br>
              <div id="trueFalse" v-if="chosenTF">
                <label for="fname">Question:</label>
                <input type="text" id="Question" name="Question"><br><br>
              
                <div>
                  <input type="radio" id="True" name="true_false" value="True">
                  <label for="True">True</label>
                </div>
                
                <div>
                  <input type="radio" id="False" name="true_false" value="False">
                  <label for="False">False</label>
                </div>
              
                <button type="button" name="button" v-on:click="AddTF_Qn">Add T/F Question</button>
              
              </div>
              
              <br>
              
              <div class = "container" id ="multiple" v-if="chosenMCQ">
                Question <input type="text" id="Question2" name="Question2"><br><br>
                
              
                Options:<br><br>
              
                <input type="text" id="option1" name="option1"><br><br>
                <input type="text" id="option2" name="option2"><br><br>
                <input type="text" id="option3" name="option3"><br><br>
                <input type="text" id="option4" name="option4"><br><br>
              
                Correct Ans:
                <input type="text" id="RightAns" name="RightAns"><br><br>
              
                <button type="button" name="button" v-on:click="AddMCQ_Qn">Add MCQ Question</button>
              
              </div>
              <br>
              <button id="final_submit" v-on:click="FinalSubmit">Final Submit</button>
            </div>
            
            
          </div>

        <script>
          var app = new Vue({
            el: '#app',
            data: {
              'course_id': 'IS111',
              'class_id': '1',
              'section_id': '3',
              'quiz_id': 'IS111-1-3',
              'time_limit': 15,
              'chosenMCQ': false,
              'chosenTF': false,
              // question_list is a list of dictionaries, each of comprises a question
              'question_list': [],
              // mcq choices is a list of the multiple choice questions
              'mcq_choices': [],
              'current_question' : {},
              'question_id': 1
            },
            methods: {
              quiz_submit: async function(){
                console.log(this.quiz_id);
                console.log(this.time_limit);
                // update the data
                let url = 'http://127.0.0.1:5000/trainers/createQuiz?quiz_id=' + this.quiz_id + '&time_limit=' + this.time_limit;
                const response = await fetch(url, {method: 'GET'});
                if(!response.ok){
                        console.log("Error in creating new quiz")
                    }
                else{
                  const data = await response.json();
                  console.log(data);
                }
              },

              showMCQ: async function(){
                this.chosenMCQ = true;
                this.chosenTF = false;
              },

              showTF: async function(){
                this.chosenTF = true;
                this.chosenMCQ = false;
              },

              AddMCQ_Qn: async function(){
                var input2 = document.getElementById('Question2').value;
                var option1 = document.getElementById('option1').value;
                var option2 = document.getElementById('option2').value;
                var option3 = document.getElementById('option3').value;
                var option4 = document.getElementById('option4').value;

                var correct_ans = document.getElementById('RightAns').value;
                this.mcq_choices.push(option1, option2, option3, option4);
                this.current_question["question"] = input2;
                this.current_question["question_id"] = this.question_id;
                this.current_question["question_type"] = 2;
                this.current_question["mcq_choices"] = this.mcq_choices
                this.current_question["answer"] = correct_ans;
                this.question_list.push(this.current_question);
                console.log(this.question_list);
                this.current_question = {}
                this.question_id +=1;
                this.mcq_choices = [];
                document.getElementById('Question2').value = "";
                document.getElementById('option1').value = "";
                document.getElementById('option2').value = "";
                document.getElementById('option3').value = "";
                document.getElementById('option4').value = "";
                console.log("MCQ has been successfully added!");
              },

              AddTF_Qn: async function(){
                var input = document.getElementById("Question").value;
                var true_false = document.querySelector('input[name="true_false"]:checked').value;
                console.log(true_false);
                this.current_question["question"] = input;
                this.current_question["question_id"] = this.question_id;
                this.current_question["question_type"] = 1
                this.current_question["answer"] = true_false;
                this.question_list.push(this.current_question);
                console.log(this.question_list);
                this.current_question = {};
                this.question_id += 1;
                document.getElementById('Question').value = "";
                
                console.log("True/False has been successfully added!")
              },

              FinalSubmit: async function(){
                let url = 'http://127.0.0.1:5000/trainers/updateQuestions'
                const response = await fetch(url, 
                {
                  method: "POST",
                  headers: {
                    "Content-type": "application/json"
                  },
                  body: JSON.stringify({
                    "quiz_id": this.quiz_id,
                    "question_list": this.question_list
                  })

                });

                if(!response.ok){
                  console.log("Error calling updateQuestions");
                }
                else{
                  const data = await response.json();
                  console.log(data);
                }
              }
              
            }
          })

        </script>
    
    </body>
</html>